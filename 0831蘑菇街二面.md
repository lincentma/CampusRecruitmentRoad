# 蘑菇街二面

> 全是项目
> 对于活动类问题问的非常详细

## 项目中面试询问计数点

### 1. 项目流程图
    - 略。

### 2. 订单中心接口的时延是多少？
    - 接口文档说明。
    - 自己的理解应该是如何降低接口的响应时间？
        - 从接口垂直与水平拆分（MapReduce）：项目没用到。。。
        - 接口缓存与本地缓存 ：对于订单的实时获取，将用户的最新订单缓存到本地，然后计算结果放入缓存？随之带来存储问题？感觉可以把用户信息缓存，省去一部分查询用户的时间比较实际？
        - 非核心流程异步化：类似于发消息，写日志，更新缓存等不会影响接口准确性的非核心流程，可以采用异步方式进行处理，不阻塞主计算逻辑处理。
        - 内部并发：项目没有考虑。
        - 参考文章：[如何减少接口响应时间](http://blog.csdn.net/xiaoxuan2015/article/details/51240872)

### 3. 高QPS下如何保证接口访问的稳定性？除了加服务器之外？
    - QPS（TPS）：每秒钟request/事务 数量
    - 并发数： 系统同时处理的request/事务数
    - 响应时间：  一般取平均响应时间

    - 自己的理解应该是业务的解耦分拆，提高并发量。具体没有实践所以需要好好学习。
    - 服务做到多少QPS，多长的耗时，应结合手头有限的资源、业务需求来制定。

    - 参考文章：[美团团购订单系统优化记](https://tech.meituan.com/meituan_tuangou_order.html)
    - 非常有价值的文章。
### 4. 高QPS下哪一个模块的压力最大？如何解决？
    - 数据库访问。引入连接池。
    - 如果在代码中显式为每次操作分别建立并释放资源，无疑增大了业务代码的复杂度，并且建立和释放连接的开销变得不可忽略。

### 5. 对于超时如何处理？
    - 尝试多调用一次
    - 使用待处理队列
    - 回滚数据
    - 使用异步机制
    - 参考文章：[【干货篇】调用其他系统http接口超时了，如何处理，方案汇总](http://blog.csdn.net/linsongbin1/article/details/50393383)

    - 自己的理解：对于活动类需要实时返回查询结果的，增加尝试调用次数是最合适的选择，要有错误策略来包容所有的错误类别。
    - 实际项目中对于API接口调用是通过RAL调用，通过配置RAL的相关超时信息设置。具体设置搞忘了。

### 6. 如何确定每一次接口数据查询范围？极端数据情况占比多少？如何考虑这部分的数据的处理？
    - 针对于活动类接口，数据查询范围是根据活动规则制定，那么如何制定活动规则保证尽可能所有多的用户满足活动？
    - 另一方面，调用其他接口获取数据量也需要根据实际需求去保证接口响应时间的可控性。
    - API接口设计的考虑因素：是否需要为一小部分数据的需求去增加所有的适配工作？还是为了保证大部分的使用体验，对于小部分进行抛出错误的设计？
    - 如何根据现有资源和条件进行权衡?

### 7. 活动中有用到消息队列吗？
    - 消息队列解决的是将突发大量请求转换为后端能承受的队列请求。
    - NMQ。
    - 参考文章：[nmq消息队列解析](http://www.cnblogs.com/lushilin/p/6209976.html)

### 8. 自己的学习目标和计划？
    - 从自己的技术博客到学习计划，巴拉巴拉。